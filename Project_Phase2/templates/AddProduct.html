{% extends 'base.html' %}
{% block css %}
    <link rel="stylesheet" type="text/css" href="{{ STATIC_URL }}css/add_style.css">
{% endblock %}
{% block js %}
    <script type="text/javascript" src="{{ STATIC_URL }}javascript/add_product.js"></script>

    <script type="text/javascript" src="{{ STATIC_URL }}javascript/jquery-1.10.2.js"></script>
    <script type="text/javascript" src="{{ STATIC_URL }}javascript/jquery.js"></script>
    <script type="text/javascript" src="{{ STATIC_URL }}javascript/jquery-1.7.2.min.js"></script>
{#    <script type="text/javascript" src="{{ STATIC_URL }}scripts/jquery.min.js"></script>#}
    <script type="text/javascript" src="{{ STATIC_URL }}scripts/jquery.imgareaselect.pack.js"></script>
    <script type="text/javascript" src="{{ STATIC_URL }}scripts/jquery.imgareaselect.min.js"></script>
    <script type="text/javascript" src="{{ STATIC_URL }}scripts/jquery.imgareaselect.js"></script>
{% endblock %}
{% block title %}
    اضافه کردن محصول جدید
{% endblock %}
{% block main_content %}
<div class="main" dir="rtl">
    <img id="background-image" src="static/images/dark-wood-wallpaper.jpg" style="z-index: -1;"/>

    <div class="my_menu">
        <ul>
            <li class="li-header">
                بخش مدیریت اجناس
            </li>
            <li>
                اضافه کردن محصول
            </li>
            <li>
                لیست محصولات ارئه شده
            </li>
            <li>
                فعالیت های من
            </li>
            <li>
                تعیین موجودی
            </li>
        </ul>
    </div>
    <ul class="breadcrumb my_crums add-pr">
        <li>
            <i class="icon-home icon-large"></i>
            <a href="/">
                ام اف شریف
            </a>
        </li>
        <li class="active">
            <span class="divider">/</span>
            اضافه کردن محصول جدید
        </li>

    </ul>
    <div class="pr-add-form">
        <div class="pr-info-header">
            اضافه کردن محصول جدید:
        </div>
        <form name="myform" id="my-add-form">
            <table>
                <tr>
                    <td class="td-input">
                        نام محصول:
                    </td>
                    <td class="td-input">
                        <input class="span2" id="name-pr" type="text" name="mytextfield"
                               style="height: 15px; margin-top:5px;padding-top: 7px;padding-bottom: 7px ; text-align: center"/>
                    </td>
                </tr>
                <tr>
                    <td class="td-input">
                        قیمت:
                    </td>
                    <td class="td-input">
                        <input class="span2" id="price-pr" type="number" value='0' name="mytextfield" min='0'
                               style="height: 15px; margin-top:5px;padding-top: 7px;padding-bottom: 7px ; text-align: center;"/>
                        تومان
                    </td>
                </tr>
                <tr>
                    <td class="td-input">
                        دسته محصول:
                    </td>
                    <td class="id-input">
                        <div id="dropdown_toggle" class="btn-group" style="margin-right:10px; ">
                            <button id="select-button" class="span2 btn dropdown-toggle" data-toggle="dropdown"
                                    dir="rtl" style="border-radius: 5px; text-align: right">
                                <span class="caret" style="margin-left:8px"></span>
                                انتخاب دسته
                            </button>
                            <ul id="dropdown_ul" class="dropdown-menu">

                            </ul>
                        </div>

                    </td>
                </tr>
                <tr>
                    <td class="td-input">
                        توضیح محصول:
                    </td>
                    <td class="td-input">
                        <input class="span5" id="info-pr" type="text" name="mytextfield"
                               style="height: 35px; margin-top:5px;padding-top: 7px;padding-bottom: 7px ; text-align: center"/>
                    </td>

                </tr>

                <tr>

                    <td class="td-input">
                        تصویر محصول:
                    </td>
                    <td class="td-input">

                    </td>
                </tr>
            </table>


        </form>

        <form id="imageForm">
{#            {% csrf_token %}#}
            <input class="span3" type="file" name="image" style="height:35px; margin-right: 120px; margin-top:-70px"
                   id="pro-img">
        </form>
        <button class="my-submit" type="button" onclick="crop()">جداکردن عکس</button>
        <button class="my-submit2" type="button" onclick="product_add()">ثبت محصول</button>


    </div>
    <p style="font-family: bnazanin; font-size: 19px; font-weight: bold; position: absolute; right: 1090px; top: 170px; color:  white;">
        جداکردن عکس
    </p>

    <div id="imageSelect">
        <img src="" id="img-select" style="width:300px; height: 300px; position: relative"/>

    </div>
    <p style="font-family: bnazanin; font-size: 19px; font-weight: bold; position: absolute; right: 895px; top: 170px; color:  white;">
        عکس نهایی
    </p>

    <div id="final-image">
        <img src="" id="img-final" style="width:100px; height: 100px; position: relative; "/>
    </div>

</div>

{% endblock %}
{% block js_very_end %}
    <script type="text/javascript" src="static/javascript/base.js"></script>
    <script type="text/javascript" src="static/javascript/add_product.js"></script>
    <script type="text/javascript">
        $(document).ready(function () {
//        $('<div><img src="static/images/2.jpg" style=" position: relative;" /><div>')
//                .css({
//                    float: 'left',
//                    position: 'relative',
//                    overflow: 'hidden',
//                    width: '100px',
//                    height: '100px'
//                })
//                .insertAfter($('#img-select'));
            $('#img-select').imgAreaSelect({ aspectRatio: '1:1', onSelectChange: preview });
        });
        function preview(img, selection) {
//        var scaleX = 100 / (selection.width || 1);
//        var scaleY = 100 / (selection.height || 1);
//
//        $('img-final').css({
//            width: Math.round(scaleX * 400) + 'px',
//            height: Math.round(scaleY * 300) + 'px',
//            marginLeft: '-' + Math.round(scaleX * selection.x1) + 'px',
//            marginTop: '-' + Math.round(scaleY * selection.y1) + 'px'
//        });
//        var scaleX = 100 * (selection.width || 1);
//        var scaleX = Math.round(selection.width / 3);
////        alert(selection.width);
////        var scaleY = 100 * (selection.height || 1);
//        var scaleY = Math.round(selection.height / 3);
//
//        var ScaleX1 = Math.round(selection.x1 / 3);
//        var ScaleY1 = Math.round(selection.y1 / 3);
//        console.log(selection.x1);
//        console.log(selection.y1);
////        alert(selection.x1);
////        alert(selection.height);
//
//        $('#img-final').css({
////            width: Math.round(scaleX / 300) + 'px',
////            height: Math.round(scaleY / 300) + 'px',
//            width: scaleX + 'px',
//            height: scaleY + 'px',
//
//            marginLeft: '-' + ScaleX1 + 'px',
//            marginTop: '-' + ScaleY1 + 'px'
//        });

            var scaleX = 100 / (selection.width || 1);
            var scaleY = 100 / (selection.height || 1);

            $('#img-final').css({
                width: Math.round(scaleX * 300) + 'px',
                height: Math.round(scaleY * 300) + 'px',
                marginRight: '-' + Math.round(scaleX * selection.x1) + 'px',
                marginTop: '-' + Math.round(scaleY * selection.y1) + 'px'
            });
        }

    </script>
{% endblock %}