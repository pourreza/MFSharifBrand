{% extends 'base.html' %}
{% block css %}
    <link rel="stylesheet" type="text/css" href="{{ STATIC_URL }}css/add_style.css">
    <link rel="stylesheet" type="text/css" href="{{ STATIC_URL }}css/imgareaselect-default.css" />
    <link rel="stylesheet" type="text/css" href="{{ STATIC_URL }}jquery.imgareaselect-0.9.10/css/imgareaselect-animated.css"/>
    <link rel="stylesheet" type="text/css" href="{{ STATIC_URL }}jquery.imgareaselect-0.9.10/css/imgareaselect-deprecated.css"/>
    <link rel="stylesheet" type="text/css" href="{{ STATIC_URL }}jquery.imgareaselect-0.9.10/css/imgareaselect-default.css"/>
{% endblock %}
{% block js %}

    <script type="text/javascript" src="{{ STATIC_URL }}javascript/jquery-1.10.2.js"></script>
    <script type="text/javascript" src="{{ STATIC_URL }}javascript/bootstrap.js"></script>
    <script type="text/javascript" src="{{ STATIC_URL }}javascript/jquery.js"></script>
    <script type="text/javascript" src="{{ STATIC_URL }}javascript/jquery-1.7.2.min.js"></script>

    <script type="text/javascript" src="{{ STATIC_URL }}scripts/jquery.min.js"></script>

    <script type="text/javascript" src="{{ STATIC_URL }}javascript/jquery.form.js"></script>
{#    <link rel="stylesheet" type="text/css" href="css/imgareaselect-default.css" />#}
{#    <script type="text/javascript" src="{{ STATIC_URL }}scripts/jquery.imgareaselect.js"></script>#}
{#    <script type="text/javascript" src="{{ STATIC_URL }}scripts/jquery.imgareaselect.pack.js"></script>#}
{#    <script type="text/javascript" src="{{ STATIC_URL }}scripts/jquery.imgareaselect.min.js"></script>#}
    <script type="text/javascript" src="{{ STATIC_URL }}jquery.imgareaselect-0.9.10/scripts/jquery.imgareaselect.js"></script>
    <script type="text/javascript" src="{{ STATIC_URL }}jquery.imgareaselect-0.9.10/scripts/jquery.imgareaselect.min.js"></script>
    <script type="text/javascript" src="{{ STATIC_URL }}jquery.imgareaselect-0.9.10/scripts/jquery.imgareaselect.pack.js"></script>
{#    <script type="text/javascript" src="{{ STATIC_URL }}javascript/add_product.js"></script>#}

{#    <script type="text/javascript" src="{{ STATIC_URL }}javascript/jquery-1.10.2.js"></script>#}
{#    <script type="text/javascript" src="{{ STATIC_URL }}javascript/jquery.js"></script>#}
{#    <script type="text/javascript" src="{{ STATIC_URL }}javascript/jquery-1.7.2.min.js"></script>#}
{#    <script type="text/javascript" src="{{ STATIC_URL }}scripts/jquery.min.js"></script>#}
{#    <script type="text/javascript" src="{{ STATIC_URL }}scripts/jquery.imgareaselect.pack.js"></script>#}
{#    <script type="text/javascript" src="{{ STATIC_URL }}scripts/jquery.imgareaselect.min.js"></script>#}
{#    <script type="text/javascript" src="{{ STATIC_URL }}scripts/jquery.imgareaselect.js"></script>#}
{% endblock %}
{% block title %}
    اضافه کردن محصول جدید
{% endblock %}
{% block main_content %}
<div class="main" dir="rtl">
    <img id="background-image" src="static/images/dark-wood-wallpaper.jpg" style="z-index: -1;"/>

    <div class="my_menu">
        <ul>
            <li class="li-header">
                بخش مدیریت اجناس
            </li>
            <li>
                اضافه کردن محصول
            </li>
            <li>
                لیست محصولات ارئه شده
            </li>
            <li>
                فعالیت های من
            </li>
            <li>
                تعیین موجودی
            </li>
        </ul>
    </div>
    <ul class="breadcrumb my_crums add-pr">
        <li>
            <i class="icon-home icon-large"></i>
            <a href="/">
                ام اف شریف
            </a>
        </li>
        <li class="active">
            <span class="divider">/</span>
            اضافه کردن محصول جدید
        </li>

    </ul>
    <div class="pr-add-form">
        <div class="pr-info-header">
            اضافه کردن محصول جدید:
        </div>
        <form action="submitProduct" method="get" name="myform" id="my-add-form">
            <table>
                <tr>
                    <td class="td-input">
                        نام محصول:
                    </td>
                    <td class="td-input">
                        <input class="span2" id="name-pr" type="text" name="mytextfield"
                               style="height: 15px; margin-top:5px;padding-top: 7px;padding-bottom: 7px ; text-align: center"/>
                    </td>
                </tr>
                <tr>
                    <td class="td-input">
                        قیمت:
                    </td>
                    <td class="td-input">
                        <input class="span2" id="price-pr" type="number" value='0' name="mytextfield" min='0'
                               style="height: 15px; margin-top:5px;padding-top: 7px;padding-bottom: 7px ; text-align: center;"/>
                        تومان
                    </td>
                </tr>
                <tr>
                    <td class="td-input">
                        دسته محصول:
                    </td>
                    <td class="id-input">
{#                        <div id="dropdown_toggle" class="btn-group" style="margin-right:10px; ">#}
{#                            <button id="select-button" class="span2 btn dropdown-toggle" data-toggle="dropdown"#}
{#                                    dir="rtl" style="border-radius: 5px; text-align: right">#}
{#                                <span class="caret" style="margin-left:8px"></span>#}
{#                                انتخاب دسته#}
{#                            </button>#}
{#                            <ul id="dropdown_ul" class="dropdown-menu">#}
{##}
{#                            </ul>#}
                        <div id="dropdown_toggle" class="btn-group" style="margin-right:10px;">
                            <button  id="select-button"  class="span2 btn dropdown-toggle" data-toggle="dropdown" dir="rtl" style="border-radius: 5px; text-align: right">
                                <span class="caret" style="margin-left:8px"></span>
                                انتخاب دسته
                            </button>
                            <ul id="dropdown_ul" class="dropdown-menu"style=" max-height:200px; overflow-y: auto;overflow-x: hidden;">

                            </ul>
                        </div>
{#                        </div>#}
{#                        <div id="dropdown_toggle" class="btn-group"style="margin-right:10px; ">#}
{#                            <button id="select-button" class="span2 btn dropdown-toggle" data-toggle="dropdown"#}
{#                                    dir="rtl" style="border-radius: 5px; text-align: right">#}
{#                                انتخاب دسته‌ها#}
{#                                <span class="caret"></span>#}
{#                            </button>#}
{#                            <ul id="dropdown_ul" class="dropdown-menu">#}
{##}
{#                            </ul>#}
{#                        </div>#}

                    </td>
                </tr>
                <tr>
                    <td class="td-input">
                        توضیح محصول:
                    </td>
                    <td class="td-input">
                        <input class="span5" id="info-pr" type="text" name="mytextfield"
                               style="height: 35px; margin-top:5px;padding-top: 7px;padding-bottom: 7px ; text-align: center"/>
                    </td>

                </tr>

{#                <tr>#}
{##}
{#                    <td class="td-input">#}
{#                        تصویر محصول:#}
{#                        <img src='{{ images.image.url }}' style="width:50px; height: 50px;">#}
{#                    </td>#}
{#                    <td class="td-input">#}
{##}
{#                    </td>#}
{#                </tr>#}
            </table>
            <input id="x1"  type="hidden" name="x1" value="0" />
            <input id="y1" type="hidden" name="y1" value="0" />
            <input id="w" type="hidden" name="w" value="0" />
            <input id="h" type="hidden" name="h" value="0" />
            <input id="hidden-image" type="hidden" name="image" value="{{ images.image.name }}" />

        </form>

{#        <form id="imageForm">#}
{#            {% csrf_token %}#}
{#            <input class="span3" type="file" name="image" style="height:35px; margin-right: 120px; margin-top:-70px"#}
{#                   id="pro-img">#}
{#        <button class="my-submit" type="button" onclick="crop()">جداکردن عکس</button>#}
        <form action="{% url 'addProduct' %}" method="post" enctype="multipart/form-data">
            {% csrf_token %}
            <span class="td-input" style="margin-top: -100px;padding-top: -100px;">
                تصویر محصول:
            </span>
            <span>{{ form.non_field_errors }}</span>
            <span style="margin-right: 8px; margin-top: 10px; ">
                {{ form.docfile.errors }}
                {{ form.docfile }}
            </span>
            <p><input class="my-submit" type="submit" value="جداکردن عکس" /></p>
        </form>
        <button class="my-submit2" type="button" onclick="product_add()">ثبت محصول</button>


    </div>
{#    <p style="font-family: bnazanin; font-size: 19px; font-weight: bold; position: absolute; right: 1090px; top: 170px; color:  white;">#}
{#        جداکردن عکس#}
{#    </p>#}
{##}
{#    <div id="imageSelect">#}
{#        <img src='{{ images.image.url }}' id="img-select" style="width:300px; height: 300px; position: relative"/>#}
{##}
{#    </div>#}
{#    <p style="font-family: bnazanin; font-size: 19px; font-weight: bold; position: absolute; right: 895px; top: 170px; color:  white;">#}
{#        عکس نهایی#}
{#    </p>#}
{##}
{#    <div id="final-image">#}
{#        <img src='{{ images.image.url }}' id="img-final" style="width:100px; height: 100px; position: relative; "/>#}
{#    </div>#}
    <p style="font-family: bnazanin; font-size: 19px; font-weight: bold; position: absolute; right: 1090px; top: 170px; color:  white;">
        جداکردن عکس
    </p>
    <div id="imageSelect" style="width:300px; height: 300px; overflow: hidden">
        <img src="{{ images.image.url }}" id="img-select" style="width:300px; height: 300px;"/>

    </div>
    <p style="font-family: bnazanin; font-size: 19px; font-weight: bold; position: absolute; right: 895px; top: 170px; color:  white;">
        عکس نهایی
    </p>
    <div id="final-image" style="width:100px; height: 100px; overflow: hidden" dir="ltr">
        <img src="{{ images.image.url }}" id="img-final" style="width:100px; height: 100px;"/>
    </div>
</div>

{% endblock %}
{% block js_very_end %}
    <script type="text/javascript" src="static/javascript/base.js"></script>
    <script type="text/javascript" src="static/javascript/add_product.js"></script>
    <script type="text/javascript">
        $(document).ready(function () {
            $('#img-select').imgAreaSelect({ aspectRatio: '1:1', handles: true , onSelectChange: preview,
                onSelectEnd: function (img, selection) {
                $('input[name="x1"]').val(selection.x1);
                $('input[name="y1"]').val(selection.y1);
                $('input[name="w"]').val(selection.x2);
                $('input[name="h"]').val(selection.y2);
            }});
        });
        function preview(img, selection) {
{#            alert("call");#}
            var scaleX = 100 / (selection.width || 1);
            var scaleY = 100 / (selection.height || 1);
            console.log("width:".concat(scaleX*300));
            console.log("height:".concat(scaleY*300));


            $('#img-final').css({
                width: (Math.round(scaleX * 300)) + 'px',
                height: (Math.round(scaleY * 300)) + 'px',
                marginLeft: '-' + Math.round(scaleX * selection.x1) + 'px',
                marginTop: '-' + Math.round(scaleY * selection.y1) + 'px'
            });
        }
    </script>


{% endblock %}